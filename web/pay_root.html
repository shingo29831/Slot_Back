
<div class="container">
    <h1>入出金フォーム</h1>
    <form id="transactionForm">
        <div class="form-group">
            <label for="userId">テーブルID</label>
            <input type="text" id="userId" name="userId" placeholder="IDを入力してください" required>
        </div>
        <div class="form-group">
            <label for="depositAmount">入金額</label>
            <input type="number" id="depositAmount" name="depositAmount" placeholder="入金額を入力してください" required>
        </div>
        <div class="form-group">
            <label for="withdrawalAmount">出金額</label>
            <input type="number" id="withdrawalAmount" name="withdrawalAmount" placeholder="出金額を入力してください" required>
        </div>
        <div id="error_message"></div>
        <button type="submit">送信</button>
    </form>
</div>

<script>
    document.getElementById('transactionForm').addEventListener('submit', function(event) {
        event.preventDefault(); // フォーム送信をキャンセル

        // フォームデータを取得
        const userId = document.getElementById('userId').value;
        const depositAmount = document.getElementById('depositAmount').value;
        const withdrawalAmount = document.getElementById('withdrawalAmount').value;

        // JSON形式でデータを作成
        const transactionData = {
            tableId: String(userId),
            depositAmount: depositAmount,
            withdrawalAmount: withdrawalAmount
        };

        // JSONデータをバックエンドに送信
        fetch('./submit-transaction', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(transactionData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.result !== "success"){
                alert("登録にエラーが発生しました")
                document.getElementById("error_message").innerText="error" + data.message 
            }else{
                alert('完了しました')
                window.location.href = "/dashboard"
            }

            console.log('Success:', data);
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    });
</script>